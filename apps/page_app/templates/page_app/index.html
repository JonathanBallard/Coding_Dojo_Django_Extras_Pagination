<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,
    initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src="script.js" defer></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" integrity="sha256-46qynGAkLSFpVbEBog43gvNhfrOj+BmwXdxFgVK/Kvc=" crossorigin="anonymous"/>


    {% load static %}

    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <script src="{% static 'js/script.js' %}"></script>

    <title>Pagination</title>
</head>
<body>



<div class="container bg-light mt-5">
    <h1 class="display-4">Pagination</h1>


    <h5 class="formHeader">Enter New Lead!</h5>
    <form id="form" action="/lead/new/" method="POST">
        <div class="form form-row">
        {% csrf_token %}

        <div class="d-inline-block mx-2">
            <h6>First Name:</h6>
            {{ lead_form.first_name }}
        </div>
        <div class="d-inline-block mx-2">
            <h6>Last Name:</h6>
            {{ lead_form.last_name }}
        </div>
        <div class="d-inline-block mx-2">
            <h6>Email:</h6>
            {{ lead_form.email }}
        </div>
        
        
    
        <div class="ml-4 btn btn-lg btn-info" id="formSubmit">Submit</div>
        </div>
    </form>

    <br><br><hr>
    <div class="pagination">
        <h1 class="display-4">Leads</h1>
        <p class="ml-auto text-lead text-primary text-lg">
            <h6 class="tPagesHeader mr-3">Table Pages</h6>
            {% for i in numPages %}
                {% if i == numPages|length %}
                    <a href='#' class="mx-2 pagLink" id="{{ i }}">{{ i }}</a>
                    
                {% else %}
                    <a href='#' class="mx-2 pagLink" id="{{ i }}">{{ i }}</a> |
                {% endif %}
            {% endfor %}
        </p>

    </div>




    <table id="table" class="table table-dark table-striped">
        <thead>
        <tr>
        <th scope="col" class="text-warning">Leads ID</th>
        <th scope="col" class="text-warning">First Name</th>
        <th scope="col" class="text-warning">Last Name</th>
        <th scope="col" class="text-warning">Registered Datetime</th>
        <th scope="col" class="text-warning">Email</th>
        </tr>
        </thead>
        <tbody id="tableBody">
            {% for lead in renderTable %}
                <tr>
                    <th scope="row">{{ lead.id }}</th>
                    <td>{{ lead.first_name }}</td>
                    <td>{{ lead.last_name }}</td>
                    <td>{{ lead.created_at }}</td>
                    <td>{{ lead.email }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>




</div>




</body>


<script>
    // formSubmit
    $(document).ready(function(){
        $(document).on('click', '#formSubmit', function(){
            $.ajax({
                url:"/lead/new/",
                method:"POST",
                data: $('#form').serialize(),
                success:function(response){
                    // add new instance to table
                    console.log('Successful Form Submittal, Response:', response)
                    $('#table').html(response)
                }
            },
            "json");

            $('#form').trigger('reset');
        })

        $(document).on('click', '.pagLink', function(){
            var id = $(this).attr('id');
            $.ajax({
                url:"/lead/" + id,
                method:"GET",
                
                success:function(response){
                    // add new instance to table
                    $('#table').html(response)
                }
            },
            "json");

            $('#form').trigger('reset');
        })

    })



</script>








</html>